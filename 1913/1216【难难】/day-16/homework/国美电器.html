<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../代码/style.css">
</head>

<body>
    <ul class="floors">
        <li class="active">1楼</li>
        <li>2楼</li>
        <li>3楼</li>
    </ul>
    <!-- <div class="main">
        <div class="main-header">
            <div class="main-header-title">1F 手机通讯</div>
            <ul class="main-header-list">
                <li class="">时尚新品</li>
                <li class="">畅享低价</li>
                <li class="">精选店铺</li>
                <li class="cur">精选单品</li>
            </ul>
        </div>
        <div class="main-body" style="border-top: 1px solid rgb(113, 158, 247);">
            <div class="main-left" style="background: rgb(113, 158, 247);">
                <img src="https://gfs10.gomein.net.cn/T17xLXBQhv1RCvBVdK.png">
                <div class="des">手机/充值/电器城</div>
                <ul>
                    <li>荣耀手机</li>
                    <li>飞利浦</li>
                    <li>潮3C</li>
                    <li>三星手机</li>
                    <li>淘实惠</li>
                    <li>配件</li>
                    <li>华为手机</li>
                    <li>全面屏</li>
                    <li>苹果</li>
                    <li>热销推荐</li>
                    <li>保护套</li>
                    <li>中兴</li>
                    <li>以旧换新</li>
                    <li>诺基亚</li>
                    <li>小米</li>
                </ul>
            </div>
            <div class="main-right">
                <ul class="main-right-list">
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1FdEXBsEv1RCvBVdK_130.jpg">
                        <div class="title">三星Note10 8</div>
                        <div class="price">¥6599.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1uJLsBvAT1RCvBVdK_130.jpg">
                        <div class="title">vivo Z5x 4</div>
                        <div class="price">¥1298.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1QjVXBb__1RCvBVdK_130.jpg">
                        <div class="title">Redmi Note</div>
                        <div class="price">¥1399.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1gKLsB_AT1RCvBVdK_130.jpg">
                        <div class="title">OPPO RenoZ</div>
                        <div class="price">¥2199.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1_sCXBbbT1RCvBVdK_130.jpg">
                        <div class="title">Redmi Note</div>
                        <div class="price">¥1799.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1klYsBgCv1RCvBVdK_130.jpg">
                        <div class="title">vivo iQOO </div>
                        <div class="price">¥1998.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1QgZXBC_v1RCvBVdK_130.jpg">
                        <div class="title">荣耀20S 6 12</div>
                        <div class="price">¥1899.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T10DAXByxT1RCvBVdK_130.jpg">
                        <div class="title">华为畅享10 Plu</div>
                        <div class="price">¥1799.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1YwhXByAT1RCvBVdK_130.jpg">
                        <div class="title">vivo iQOO </div>
                        <div class="price">¥3198.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1GfDsBv_T1RCvBVdK_130.jpg">
                        <div class="title">荣耀20 8 256</div>
                        <div class="price">¥2999.00</div>
                    </li>
                </ul>
            </div>
            <div class="main-right">
                <ul class="main-right-list">
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1vMJvByDb1RCvBVdK_130.jpg">
                        <div class="title">三星A60 6 12</div>
                        <div class="price">¥1999.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T170LgBQ_v1RCvBVdK_130.jpg">
                        <div class="title">荣耀V20 8 12</div>
                        <div class="price">¥2488.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1WF_bByLv1RCvBVdK_130.jpg">
                        <div class="title">荣耀8X Max 全</div>
                        <div class="price">¥1399.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1NOWjBvYv1RCvBVdK_130.jpg">
                        <div class="title">iPhone XS </div>
                        <div class="price">¥8288.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1BUxgBQdv1RCvBVdK_130.jpg">
                        <div class="title">小米Play 6 </div>
                        <div class="price">¥1099.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T120hXBbdv1RCvBVdK_130.jpg">
                        <div class="title">荣耀9X Pro 8</div>
                        <div class="price">¥2099.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1IEEsBTh_1RCvBVdK_130.jpg">
                        <div class="title">华为P30 8 12</div>
                        <div class="price">¥4288.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1JRdjBbdT1RCvBVdK_130.jpg">
                        <div class="title">iPhone XR </div>
                        <div class="price">¥4488.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1HLx_BgJv1RCvBVdK_130.jpg">
                        <div class="title">荣耀Note10 6</div>
                        <div class="price">¥2499.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1ORbXB7Wv1RCvBVdK_130.jpg">
                        <div class="title">华为nova4e 6</div>
                        <div class="price">¥1599.00</div>
                    </li>
                </ul>
            </div>
            <div class="main-right">
                <ul class="main-right-list">
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1E0_XBTEv1RCvBVdK_130.jpg">
                        <div class="title">华为nova 5 P</div>
                        <div class="price">¥2999.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1kGxbByW_1RCvBVdK_130.jpg">
                        <div class="title">Redmi Note</div>
                        <div class="price">¥1399.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1XU_sBKDT1RCvBVdK_130.jpg">
                        <div class="title">Redmi note</div>
                        <div class="price">¥1086.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1VrKXByWv1RCvBVdK_130.jpg">
                        <div class="title">vivo iQOO </div>
                        <div class="price">¥3198.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1x9xgBgWv1RCvBVdK_130.jpg">
                        <div class="title">iPhone XR </div>
                        <div class="price">¥4526.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1lkEsBKA_1RCvBVdK_130.jpg">
                        <div class="title">荣耀V20 8 12</div>
                        <div class="price">¥2399.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1Yfb_BgV_1RCvBVdK_130.jpg">
                        <div class="title">荣耀20i 4 1</div>
                        <div class="price">¥1196.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1aK_QB4Ev1RCvBVdK_130.jpg">
                        <div class="title">华为Mate 20 </div>
                        <div class="price">¥2999.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1QZhgBKKv1RCvBVdK_130.jpg">
                        <div class="title">华为Mate20 P</div>
                        <div class="price">¥3666.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1wQWXB7ET1RCvBVdK_130.jpg">
                        <div class="title">Redmi Note</div>
                        <div class="price">¥1686.00</div>
                    </li>
                </ul>
            </div>
            <div class="main-right current">
                <ul class="main-right-list">
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1aK_QB4Ev1RCvBVdK_130.jpg">
                        <div class="title">华为 Mate 20</div>
                        <div class="price">¥2999.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1NnxXByVT1RCvBVdK_130.jpg">
                        <div class="title">OPPO Reno2</div>
                        <div class="price">¥2999.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1NhxsBmYv1RCvBVdK_130.jpg">
                        <div class="title">vivo X27 P</div>
                        <div class="price">¥3298.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1ceYvB4VQ1RCvBVdK_130.jpg">
                        <div class="title">华为P30 Pro </div>
                        <div class="price">¥5299.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1xnxsBXZv1RCvBVdK_130.jpg">
                        <div class="title">小米CC9 6 6</div>
                        <div class="price">¥1799.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1lLhjBXAv1RCvBVdK_130.jpg">
                        <div class="title">华为Mate20 P</div>
                        <div class="price">¥4199.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1.fxjB7Av1RCvBVdK_130.jpg">
                        <div class="title">iPhone8 64</div>
                        <div class="price">¥3356.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1I_AbBsZv1RCvBVdK_130.jpg">
                        <div class="title">华为P30 8 12</div>
                        <div class="price">¥4288.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1TGb_B7Zv1RCvBVdK_130.jpg">
                        <div class="title">华为Mate 20 </div>
                        <div class="price">¥3499.00</div>
                    </li>
                    <li>
                        <img src="https://gfs17.gomein.net.cn/T1kGxbByW_1RCvBVdK_130.jpg">
                        <div class="title">Redmi Note</div>
                        <div class="price">¥1399.00</div>
                    </li>
                </ul>
            </div>
        </div>
    </div> -->
</body>
<script src="../代码/国美数据.js"></script>
<script>
    //提供构造函数
    function Mannager(floor) {
        this.root = null;
        this.data = floor;
    }
    //设置原型对象
    Mannager.prototype = {
        constructor: Mannager,
        init: function () {
            this.renderUI();
            this._insert();
            this.addEventHandler();
        }

        //创建节点&渲染
        , renderUI: function () {
            this.root = document.createElement("div");
            this.root.className = "main";
            var curdata = this.data;

            var goods = curdata.list;

            var html4 = '';
            goods.forEach(function (item4, index) {
                var html3 = item4.map(function (item) {
                    return `<li>
                        <img src="${item.src}">
                        <div class="title">${(item.title.length > 9) ? item.title.slice(0, 9) : item.title}</div>
                        <div class="price">${item.price}</div>
                    </li>`;
                }).join('')
                html4 += `<div class="main-right ${index == (goods.length - 1) ? 'current' : ''}"><ul class="main-right-list">${html3}</ul>
            </div>`
            })

            var html2 = curdata.types.map(function (item) {
                return `<li>${item}</li>`;
            }).join('')
            var html1 = curdata.tabs.map(function (item) {
                return `<li class="">${item}</li>`;
            }).join('')

            var html = `

        <div class="main-header">
            <div class="main-header-title">${this.data.name}</div>
            <ul class="main-header-list">
            ${html1}
            </ul>
        </div>
        <div class="main-body" style="border-top: 1px solid rgb(113, 158, 247);">
            <div class="main-left" style="background: rgb(113, 158, 247);">
                <img src="https://gfs10.gomein.net.cn/T17xLXBQhv1RCvBVdK.png">
                <div class="des">${this.data.des}</div>
                <ul>
            ${html2}
                </ul>
            </div>
        ${html4}
        </div>`;
            this.root.innerHTML = html;
            // 循环生成tabs
            //循环生成types
            //循环生成main-right中的li

            // data=[{1楼}{2楼}{3楼}]
            // 某楼中的list：[[详细页1][详细页2][详细页3][详细页4]]
            // 详细页数组框：[{有总数为10的商品li}{}.....{}]
            var auls = this.root.querySelectorAll('.main-right')
            var nav = this.root.querySelector('.main-header-list')
            var type = this.root.querySelector('.types')





        }



        //插入节点
        , _insert: function () {
            document.body.appendChild(this.root);
        }

        //实现功能
        , addEventHandler() {
            //01.通过事件委托点击main-header-list下面的li实现下面main-right内容页面更换
            var clickfloor = document.querySelectorAll('.main');
            for (var i = 0; i < clickfloor.length; i++) {
                // clickfloor[i].index = i;
                clickfloor[i].onclick = function () {
                    var hitboxs = this.querySelectorAll('.main-header-list li');
                    var hitbox = this.querySelector('.main-header-list');
                    var details = this.querySelectorAll('.main-right');
                    for (var j = 0; j < hitboxs.length; j++) {
                        hitboxs[j].index = j;
                        hitbox.onclick = function (ev) {
                            // console.log(ev.target.index)
                            // 排他。添加class名
                            for (var i in hitboxs) {
                                hitboxs[i].className = '';
                            }
                            ev.target.classList.add('cur');
                            for (var k = 0; k < details.length; k++) {
                                details[k].classList.remove('current');
                            }
                            details[ev.target.index].classList.add('current')
                        }
                    }
                }
            }



            //楼层跳跃
            var floors = document.querySelector('.floors');
            var floorsli = document.querySelectorAll('.floors li');
            //点击跳楼----利用window.scrollTo(0, y)
            for (var j = 0; j < floorsli.length; j++) {
                floorsli[j].index = j;
                floors.onclick = function (ev) {
                    let iTop = clickfloor[ev.target.index].offsetTop;
                    for (var k = 0; k < floorsli.length; k++) {
                        floorsli[k].classList.remove('active');
                    }
                    window.scrollTo(0, iTop)
                    ev.target.classList.add('active')
                }
            }


            //滑轮滚动时跳楼
            window.onscroll = function () {
                let scrollTop = window.scrollY;//滚动距离
                for (let i = 0; i < clickfloor.length; i++) {
                    if (scrollTop >= clickfloor[i].offsetTop - 200) {
                        for (var j = 0; j < floorsli.length; j++) {
                            floorsli[j].className = '';
                        }
                        floorsli[i].className = 'active';
                        console.log(floorsli[i])
                    }
                }
            }



            //bug:
        }
    }




    //函数构造实例对象  并调用原型对象
    var mannager1 = new Mannager(data[0]).init();
    var mannager2 = new Mannager(data[1]).init();
    var mannager3 = new Mannager(data[2]).init();
    // mannager.init();.init()


</script>

</html>